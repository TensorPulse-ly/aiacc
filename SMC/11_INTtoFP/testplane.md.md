# inttofp 测试计划 (inttofp_testplan.md)

> **版本**：v1.0  
> **作者**：cypher  
> **覆盖**：128-bit SIMD 整数转浮点转换单元，支持 32-bit×4 或 16-bit×8 通道，支持有符号/无符号输入  

---

## 1. 引言  
覆盖 inttofp 全功能测试，包括通道精度切换、符号扩展、高低位选择、边界值处理及浮点转换正确性验证。

---

## 2. 验证目标

| 目标类别 | 描述 |
|----------|------|
| 功能正确性 | 输出与 SoftFloat 参考模型一致 |
| 精度兼容性 | 16-bit×8 / 32-bit×4 模式无缝切换 |
| 符号处理 | 有符号/无符号输入正确处理 |
| 高低位选择 | 32↔16 转换时高/低位选择正确 |
| 边界鲁棒性 | 极值、零值、符号边界 |
| 覆盖率 | 行≥95%，分支≥90%，功能点 100% |

---

## 3. 测试方法

| 方法 | 工具/实现 |
|------|-----------|
| 参考模型 | SoftFloat DPI-C |
| 定向测试 | 边界值/特殊场景（0、±1、max、min） |
| 随机测试 | 100 组随机操作数+控制信号组合 |
| 波形检查 | Verdi 信号分析 |
| 覆盖率收集 | VCS/URG |

---

## 4. 测试场景

### 4.1 基础转换测试

| ID | 场景 | 输入示例 |
|----|------|----------|
| BC-01 | 32-bit 有符号转 float | `0x00000001` → `0x3f800000` |
| BC-02 | 32-bit 无符号转 float | `0xffffffff` → `0x4f800000` |
| BC-03 | 16-bit 有符号转 float | `0x7fff` → `0x7800` |
| BC-04 | 16-bit 无符号转 float | `0xffff` → `0xbc00` |

---

### 4.2 精度切换测试

| ID | 场景 | 关键验证点 |
|----|------|-------------|
| PS-01 | 16→32 扩展 | `0xffff`（有符号）→ `0xbf800000` |
| PS-02 | 32→16 拆分 | `0x7fff0000` → `0x7800`（高位） |
| PS-03 | 高低位选择 | `src_high=1` 时选高 16-bit |

---

### 4.3 符号扩展测试

| ID | 场景 | 关键验证点 |
|----|------|-------------|
| SE-01 | 有符号负数扩展 | `0x8000` → `0xc7000000` |
| SE-02 | 无符号零扩展 | `0x8000` → `0x47800000` |

---

### 4.4 边界值测试

| ID | 场景 | 关键验证点 |
|----|------|-------------|
| BV-01 | 32-bit 最大正数 | `0x7fffffff` → `0x4f000000` |
| BV-02 | 32-bit 最小负数 | `0x80000000` → `0xcf000000` |
| BV-03 | 16-bit 最大正数 | `0x7fff` → `0x7800` |
| BV-04 | 16-bit 最小负数 | `0x8000` → `0xf800` |

---

### 4.5 随机测试

| ID | 场景 | 描述 |
|----|------|------|
| RT-01 | 随机数据+控制 | 100 组随机 128-bit 输入+控制信号 |

---

## 5. 验证环境

| 工具 | 用途 |
|------|------|
| VCS | RTL 编译/仿真 |
| Verdi | 波形调试 |
| SoftFloat | 黄金参考模型 |
| URG | 覆盖率分析 |

---

## 6. 回归策略

- 代码更新后自动触发全量测试集  
- 历史缺陷用例加入回归池（如符号扩展缺陷）  
- 覆盖率未达标阻塞代码合入

---

## 7. 验收标准

| 指标 | 要求 |
|------|------|
| 功能通过率 | 100% |
| 行覆盖率 | ≥95% |
| 边界用例 | 100% 覆盖 |
| 致命缺陷 | 0 |

---

## 附录：关键覆盖点

| 覆盖组 | 覆盖目标 |
|--------|----------|
| 精度模式 | 16-bit / 32-bit 模式切换 |
| 符号模式 | 有符号 / 无符号输入 |
| 高低位选择 | src_high / dst_high 控制 |
| 边界值 | 零值、极值、符号边界 |
| 通道独立性 | 每通道结果独立正确 |