# INTtoINT 模块测试计划

> Author: [Oliver]  
> Editor: [Oliver]  
> Date: 2025-8-30  
> Version: 1.0  

## 1 测试概述

### 1.1 测试目标

- 验证基础整数转换单元(int_to_int.v)的功能正确性
- 验证四路并行转换阵列(int_to_int_array.v)的并行处理能力
- 验证指令控制、符号扩展、精度切换、饱和处理等功能
- 覆盖所有数据类型组合（s32/u32 ↔ s16/u16）和位置（高/低位）
- 全面覆盖所有数据类型组合、符号处理和边界条件
- 验证指令控制机制和无效指令处理

### 1.2 测试覆盖率目标

- **功能覆盖率**：100%
- **代码覆盖率**：≥95%
- **边界值覆盖率**：100%
- **控制路径覆盖率**：100%

---

## 2 验证目标

| 目标类别 | 描述 |
|----------|------|
| **功能正确性** | 输出与DPI-C参考模型一致 |
| **精度兼容性** | 16/32位模式切换、有/无符号转换 |
| **边界鲁棒性** | 饱和处理、符号扩展、零值、极值 |
| **指令控制** | 指令有效/无效处理机制 |
| **阵列并行性** | 四路并行处理一致性 |
| **覆盖率** | 行覆盖≥95%，分支覆盖≥95% |

---

## 3. 基础单元测试用例 (int_to_int.v)

### 3.1 32位到32位转换测试

| 测试ID | 描述 | 输入数据 | 控制信号 | 预期输出 |
|--------|------|----------|----------|----------|
| **S32S32-001** | s32(127)→s32 | 32'h0000007F | 7'b1111111 | 32'h0000007F |
| **S32S32-002** | s32(-128)→s32 | 32'hFFFFFF80 | 7'b1111111 | 32'hFFFFFF80 |
| **S32S32-003** | s32最大值→s32 | 32'h7FFFFFFF | 7'b1111111 | 32'h7FFFFFFF |
| **S32S32-004** | s32最小值→s32 | 32'h80000000 | 7'b1111111 | 32'h80000000 |
| **S32U32-001** | s32(127)→u32 | 32'h0000007F | 7'b1111011 | 32'h0000007F |
| **S32U32-002** | s32(-128)→u32 | 32'hFFFFFF80 | 7'b1111011 | 32'h00000000 |
| **S32U32-003** | s32(-1)→u32 | 32'hFFFFFFFF | 7'b1111011 | 32'h00000000 |
| **U32S32-001** | u32(255)→s32 | 32'h000000FF | 7'b1101111 | 32'h000000FF |
| **U32S32-002** | u32(2147483648)→s32 | 32'h80000000 | 7'b1101111 | 32'h7FFFFFFF |
| **U32U32-001** | u32(255)→u32 | 32'h000000FF | 7'b1100011 | 32'h000000FF |

### 3.2 32位到16位转换测试

| 测试ID | 描述 | 输入数据 | 控制信号 | 预期输出 |
|--------|------|----------|----------|----------|
| **S32S16-001** | s32(32767)→s16低位 | 32'h00007FFF | 7'b1011110 | 32'h00007FFF |
| **S32S16-002** | s32(32768)→s16低位 | 32'h00008000 | 7'b1011110 | 32'h00007FFF |
| **S32S16-003** | s32(-32768)→s16低位 | 32'hFFFF8000 | 7'b1011110 | 32'hFFFF8000 |
| **S32S16-004** | s32(-32769)→s16低位 | 32'hFFFF7FFF | 7'b1011110 | 32'hFFFF8000 |
| **S32S16-005** | s32(32767)→s16高位 | 32'h00007FFF | 7'b1011111 | 32'h7FFF0000 |
| **S32U16-001** | s32(32767)→u16低位 | 32'h00007FFF | 7'b1010010 | 32'h00007FFF |
| **S32U16-002** | s32(-32768)→u16低位 | 32'hFFFF8000 | 7'b1010010 | 32'h00000000 |
| **U32S16-001** | u32(65535)→s16低位 | 32'h0000FFFF | 7'b1001110 | 32'h00007FFF |
| **U32U16-001** | u32(65535)→u16低位 | 32'h0000FFFF | 7'b1000010 | 32'h0000FFFF |
| **U32U16-002** | u32(65536)→u16低位 | 32'h00010000 | 7'b1000010 | 32'h0000FFFF |

### 3.3 16位到32位转换测试

| 测试ID | 描述 | 输入数据 | 控制信号 | 预期输出 |
|--------|------|----------|----------|----------|
| **S16S32-001** | s16(32767)低位→s32 | 32'h00007FFF | 7'b0111000 | 32'h00007FFF |
| **S16S32-002** | s16(-32768)低位→s32 | 32'h00008000 | 7'b0111000 | 32'hFFFF8000 |
| **S16S32-003** | s16(32767)高位→s32 | 32'h7FFF0000 | 7'b0111001 | 32'h00007FFF |
| **S16S32-004** | s16(-32768)高位→s32 | 32'h80000000 | 7'b0111001 | 32'hFFFF8000 |
| **S16U32-001** | s16(32767)低位→u32 | 32'h00007FFF | 7'b0110000 | 32'h00007FFF |
| **S16U32-002** | s16(-32768)低位→u32 | 32'h00008000 | 7'b0110000 | 32'h00000000 |
| **U16S32-001** | u16(65535)低位→s32 | 32'h0000FFFF | 7'b0101000 | 32'h0000FFFF |
| **U16S32-002** | u16(65535)高位→s32 | 32'hFFFF0000 | 7'b0101001 | 32'h0000FFFF |
| **U16U32-001** | u16(65535)低位→u32 | 32'h0000FFFF | 7'b0100000 | 32'h0000FFFF |
| **U16U32-002** | u16(32767)高位→u32 | 32'h7FFF0000 | 7'b0100001 | 32'h00007FFF |

### 3.4 16位到16位转换测试

| 测试ID | 描述 | 输入数据 | 控制信号 | 预期输出 |
|--------|------|----------|----------|----------|
| **S16S16-001** | s16(32767,-32768)→s16 | 32'h7FFF8000 | 7'b0011111 | 32'h7FFF8000 |
| **S16S16-002** | s16(0,-1)→s16 | 32'h0000FFFF | 7'b0011111 | 32'h0000FFFF |
| **S16U16-001** | s16(32767,-32768)→u16 | 32'h7FFF8000 | 7'b0010011 | 32'h7FFF0000 |
| **S16U16-002** | s16(128,65407)→u16 | 32'h0080FF7F | 7'b0010011 | 32'h00800000 |
| **U16S16-001** | u16(65535,1)→s16 | 32'hFFFF0001 | 7'b0001111 | 32'h7FFF0001 |
| **U16S16-002** | u16(32767,32768)→s16 | 32'h7FFF8000 | 7'b0001111 | 32'h7FFF7FFF |
| **U16U16-001** | u16(65535,1)→u16 | 32'hFFFF0001 | 7'b0000011 | 32'hFFFF0001 |
| **U16U16-002** | u16(32767,32768)→u16 | 32'h7FFF8000 | 7'b0000011 | 32'h7FFF8000 |
| **S16S16-003** | s16(32640,32640)→s16 | 32'h7F807F80 | 7'b0011111 | 32'h7F807F80 |
| **S16S16-004** | s16(128,128)→s16 | 32'h00800080 | 7'b0011111 | 32'h00800080 |

### 3.5 指令控制测试

| 测试ID | 描述 | 输入数据 | 控制信号 | 预期输出 |
|--------|------|----------|----------|----------|
| **CTL-001** | 指令有效测试 | 32'h00007FFF | 7'b1111111 | 转换结果 |
| **CTL-002** | 指令无效测试 | 32'h00007FFF | 7'b1111110 | 32'h00000000 |

### 3.6 随机测试

- **RND-000** 至 **RND-999**: 1000组随机数据+控制信号组合测试，覆盖全控制信号组合和数据范围

---

## 4 阵列测试用例 (int_to_int_array.v)

### 4.1 32位到32位阵列转换

| 测试ID | 描述 | 输入数据[127:0] | 控制信号 | 预期输出[127:0] |
|--------|------|---------------|----------|---------------|
| **ARR-S32S32-001** | 四路s32→s32正常值 | 32'h0000007F, 32'hFFFFFF80, 32'h7FFFFFFF, 32'h80000000 | 7'b1111111 | 同输入值 |
| **ARR-S32S32-002** | 四路s32→s32边界值 | 32'h00000001, 32'h00000000, 32'hFFFFFFFF, 32'h7FFFFFFE | 7'b1111111 | 同输入值 |
| **ARR-S32U32-001** | 四路s32→u32正数 | 32'h0000007F, 32'h000000FF, 32'h00007FFF, 32'h0000FFFF | 7'b1111011 | 同输入值 |
| **ARR-S32U32-002** | 四路s32→u32负数 | 32'hFFFFFF80, 32'hFFFFFFFF, 32'hFFFF8000, 32'hFFFF0000 | 7'b1111011 | 32'h00000000, 32'h00000000, 32'h00000000, 32'h00000000 |

## 4.2 32位到16位阵列转换

| 测试ID | 描述 | 输入数据[127:0] | 控制信号 | 预期输出[127:0] |
|--------|------|---------------|----------|---------------|
| **ARR-S32S16-001** | 四路s32→s16低位正常 | 32'h00007FFF, 32'hFFFF8000, 32'h0000007F, 32'hFFFFFF81 | 7'b1011110 | 32'h00007FFF, 32'hFFFF8000, 32'h0000007F, 32'hFFFFFF81 |
| **ARR-S32S16-002** | 四路s32→s16低位饱和 | 32'h00008000, 32'hFFFF7FFF, 32'h00010000, 32'hFFFEFFFF | 7'b1011110 | 32'h00007FFF, 32'hFFFF8000, 32'h00007FFF, 32'hFFFF8000 |
| **ARR-S32S16-003** | 四路s32→s16高位正常 | 32'h00007FFF, 32'hFFFF8000, 32'h0000007F, 32'hFFFFFF81 | 7'b1011111 | 高位打包结果 |
| **ARR-S32U16-001** | 四路s32→u16低位正数 | 32'h00007FFF, 32'h0000007F, 32'h0000FFFF, 32'h00000001 | 7'b1010010 | 同输入值 |
| **ARR-S32U16-002** | 四路s32→u16低位负数 | 32'hFFFF8000, 32'hFFFFFFFF, 32'hFFFFFFFE, 32'h80000000 | 7'b1010010 | 32'h00000000, 32'h00000000, 32'h00000000, 32'h00000000 |
| **ARR-U32U16-001** | 四路u32→u16低位 | 32'h0000FFFF, 32'h00010000, 32'h00000000, 32'h00007FFF | 7'b1000010 | 32'h0000FFFF, 32'h0000FFFF, 32'h00000000, 32'h00007FFF |

### 4.3 16位到32位阵列转换

| 测试ID | 描述 | 输入数据[127:0] | 控制信号 | 预期输出[127:0] |
|--------|------|---------------|----------|---------------|
| **ARR-S16S32-001** | 四路s16低位→s32正数 | 32'h00007FFF, 32'h0000007F, 32'h00000001, 32'h00000FFF | 7'b0111000 | 符号扩展结果 |
| **ARR-S16S32-002** | 四路s16低位→s32负数 | 32'h00008000, 32'h0000FFFF, 32'h0000FFFE, 32'h0000F000 | 7'b0111000 | 符号扩展结果 |
| **ARR-S16S32-003** | 四路s16高位→s32正数 | 32'h7FFF0000, 32'h007F0000, 32'h00010000, 32'h0FFF0000 | 7'b0111001 | 符号扩展结果 |
| **ARR-S16S32-004** | 四路s16高位→s32负数 | 32'h80000000, 32'hFFFF0000, 32'hFFFE0000, 32'hF0000000 | 7'b0111001 | 符号扩展结果 |
| **ARR-U16U32-001** | 四路u16低位→u32 | 32'h0000FFFF, 32'h00007FFF, 32'h000000FF, 32'h00000000 | 7'b0100000 | 零扩展结果 |
| **ARR-S16U32-001** | 四路s16低位→u32 | 32'h00007FFF, 32'h00008000, 32'h0000007F, 32'h0000FFFF | 7'b0110000 | 32'h00007FFF, 32'h00000000, 32'h0000007F, 32'h00000000 |

### 4.4 16位到16位阵列转换

| 测试ID | 描述 | 输入数据[127:0] | 控制信号 | 预期输出[127:0] |
|--------|------|---------------|----------|---------------|
| **ARR-S16S16-001** | 四路s16→s16正常值 | 32'h7FFF8000, 32'h0000FFFF, 32'h7F807F80, 32'h00800080 | 7'b0011111 | 同输入值 |
| **ARR-S16S16-002** | 四路s16→s16边界值 | 32'h7FFF7FFF, 32'h80008000, 32'h00010001, 32'hFFFEFFFE | 7'b0011111 | 同输入值 |
| **ARR-S16U16-001** | 四路s16→u16正数 | 32'h7FFF8000, 32'h0000FFFF, 32'h7F807F80, 32'h00800080 | 7'b0010011 | 32'h7FFF0000, 32'h00000000, 32'h7F807F80, 32'h00800080 |
| **ARR-S16U16-002** | 四路s16→u16混合 | 32'h7FFF0001, 32'h80007FFF, 32'h0080FF7F, 32'hFFFF0000 | 7'b0010011 | 32'h7FFF0001, 32'h00007FFF, 32'h00800000, 32'h00000000 |
| **ARR-U16S16-001** | 四路u16→s16正常 | 32'hFFFF0001, 32'h7FFF8000, 32'h0080007F, 32'h7F807F80 | 7'b0001111 | 32'h7FFF0001, 32'h7FFF7FFF, 32'h0080007F, 32'h7F807F80 |
| **ARR-U16U16-001** | 四路u16→u16 | 32'hFFFF0001, 32'h7FFF8000, 32'h0080007F, 32'h7F807F80 | 7'b0000011 | 同输入值 |

### 4.5 特殊值阵列测试

| 测试ID | 描述 | 输入数据[127:0] | 控制信号 | 预期输出[127:0] |
|--------|------|---------------|----------|---------------|
| **ARR-ZERO-001** | 四路零值处理 | 32'h00000000, 32'h00000000, 32'h00000000, 32'h00000000 | 7'b1111111 | 全零输出 |
| **ARR-BOUND-001** | 四路极值处理 | 32'h7FFFFFFF, 32'h80000000, 32'h0000FFFF, 32'hFFFF0000 | 7'b1111111 | 相应边界处理结果 |

### 4.6 指令无效测试

| 测试ID | 描述 | 输入数据[127:0] | 控制信号 | 预期输出[127:0] |
|--------|------|---------------|----------|---------------|
| **ARR-CTL-001** | 阵列指令无效测试 | 32'h12345678, 32'h9ABCDEF0, 32'h11112222, 32'h33334444 | 7'b0000000 | 32'h00000000, 32'h00000000, 32'h00000000, 32'h00000000 |

---

## 5 测试策略

### 5.1 测试方法

| 方法 | 工具/实现 |
|------|------------|
| **参考模型** | DPI-C函数 `dpi_int_to_int_convert` |
| **定向测试** | 边界值、特殊值、控制信号组合 |
| **随机测试** | 1000组随机操作数+控制信号组合 |
| **波形检查** | VCD/FSDB波形分析 |
| **覆盖率收集** | VCS/URG |

### 5.2 验证环境

| 工具 | 用途 |
|------|------|
| VCS | RTL编译与仿真 |
| DPI-C | 参考模型接口 |
| Verdi | 波形调试与分析 |
| URG | 覆盖率分析 |

---

## 6 验收标准

| 指标 | 要求 |
|------|------|
| 功能通过率 | 100% |
| 行覆盖率 | ≥95% |
| 分支覆盖率 | ≥95% |
| 边界用例覆盖 | 100% |
| 致命缺陷 | 0 |

---

## 历史版本

- **V1.0**: 初始版本，针对整数转换基础单元与四路并行阵列的完整功能验证测试计划，覆盖所有数据类型、边界条件及指令控制场景。

---

## 附录：关键覆盖点

| 覆盖组 | 覆盖目标 |
|--------|----------|
| **精度切换** | 16/32位模式全组合 |
| **符号处理** | 有符号/无符号全组合 |
| **位置选择** | 高/低位提取全组合 |
| **饱和处理** | 上下界饱和机制 |
| **指令控制** | 有效/无效指令处理 |
| **并行处理** | 四路并行一致性 |
