# INTADD 整数加法器测试计划

## 1. 测试概述

### 1.1 测试目标
- 验证 INTADD 模块的 4-bit+8-bit（add8）和 32-bit（add32）整数加法功能是否正确
- 覆盖所有合法和非法精度组合输入
- 验证符号扩展逻辑的正确性
- 检查边界值与溢出时的饱和处理
- 执行大规模随机测试以验证模块稳定性

### 1.2 测试覆盖率目标
- **功能覆盖率**：≥95%
- **代码覆盖率**：≥90%
- **精度组合覆盖率**：100%
- **边界值与符号扩展覆盖率**：100%

---

## 2. 测试任务与用例

### 2.1 Task 1: 初始化任务

#### 用例说明
- 所有输入初始化为 0
- 保证测试起始状态干净，防止寄存值影响仿真

---

### 2.2 Task 2: 4-bit + 8-bit 模式随机测试（add8）

#### 输入配置
- precision_s0 = 2'b00
- precision_s1 = 2'b00
- precision_s2 = 2'b00
- sign_sX = 随机（无符号或有符号）

#### 用例行为
- 以 4-bit 为单位填充 src_reg0/1/2 的 32 个 segment
- 组合成 4-bit + 8-bit 加法运算（并行32路）
- 检查 dst_reg0（低4位）与 dst_reg1（高4位）是否正确

#### 特别检查点
- 有符号与无符号混合输入是否扩展正确
- 和大于255时是否饱和为 8'hFF

---

### 2.3 Task 3: 32-bit + 32-bit 模式随机测试（add32）

#### 输入配置
- precision_s0 = 2'b11
- precision_s1 = 2'b11
- precision_s2 = 不使用
- sign_s0, sign_s1 = 随机

#### 用例行为
- 以 32-bit 为单位填充 src_reg0/1 的 4 个 segment
- 执行 add32 并检查 dst_reg0 输出是否正确

#### 特别检查点
- 有符号负数结果是否溢出并饱和为 0xFFFFFFFF
- 无符号正溢出是否处理正确
- 符号扩展是否按 sign_sX 控制执行

---

### 2.4 Task 4: 全随机配置测试

#### 输入配置
- 所有 precision_sX 和 sign_sX 均为随机
- inst_valid 随机为 0 或 1

#### 用例行为
- 根据精度组合决定是否进行 add8 / add32 / 输出全0
- 若组合非法，检查 dst_reg0/dst_reg1 是否为全零

#### 特别检查点
- 合法组合必须正常输出
- 非法组合（例如 precision_s0 ≠ precision_s1）时输出应为 0
- inst_valid = 0 时输出必须为 0

---

### 2.5 Task 5: 边界值测试（手动赋值）

#### 用例集合

- Case 1: add8 无符号饱和边界  
  src_reg0 = 4'd2  
  src_reg1 = 4'd15  
  src_reg2 = 4'd15  
  → sum = 2 + 254 = 256 → 饱和为 0xFF

- Case 2: add8 有符号下溢边界  
  src_reg0 = 1100  
  src_reg1 = 0001 
  src_reg2 = 1000  
  → sum = -131 → 下溢为 -128 (表示为0xFF)

- Case 3: add32 无符号最大值溢出  
  src_reg0 = 0xFFFFFFFE  
  src_reg1 = 0x00000002  
  → sum = 0x100000000 → 饱和为 0xFFFFFFFF

- Case 4: add32 有符号最小值下溢  
  src_reg0 = -2147483647 (0x80000001)  
  src_reg1 = -2 (0xFFFFFFFE)  
  → sum = -2147483649 → 下溢为 -2147483648 (表示为0xFFFFFFFF)

---

## 3. 随机化与回归测试

### 3.1 随机组合测试
- 随机组合 precision_sX、sign_sX、inst_valid
- 自动执行 100 组全随机测试
- 包含所有边界情况和无效组合

### 3.2 回归测试集
- 集成历史所有异常场景
- 定期执行 Task 5 验证边界结果是否发生改变

---

## 4. 测试环境与工具

### 4.1 仿真平台
- 仿真器：Synopsys VCS / Modelsim
- 语言：Verilog
- 波形输出：FSDB格式
- 仿真脚本：Makefile 脚本

### 4.2 测试组件
- DUT：intadd.v
- 测试平台：intadd_tb.v
- 驱动脚本：任务自动执行 + 输出检查
- 可选参考模型：Python 版逐比特模拟器

---

## 5. 验收标准

### 5.1 功能正确性
- [ ] add8 模式下 32 路并行计算正确
- [ ] add32 模式下 4 路 32-bit 运算正确
- [ ] 所有边界值和符号扩展行为正确
- [ ] inst_valid 控制有效输出逻辑正确

### 5.2 覆盖率要求
- [ ] 功能覆盖率 ≥ 95%
- [ ] 代码覆盖率 ≥ 90%
- [ ] 精度组合覆盖率 100%
- [ ] 符号扩展路径覆盖完整

### 5.3 回归一致性
- [ ] 所有历史 bug 场景回归测试通过
- [ ] 所有边界条件稳定且可重现
- [ ] 与设计规格保持一致

---

**测试计划版本**：V1.0  
**创建日期**：2025年5月13日  
**预计完成时间**：2025年7月20日  
**负责人**：XXX  
